<!DOCTYPE html>
<html>
    <head>
        <title>Collect'IF - Page d'Accueil</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <!--
		<meta name="viewport" content="width=device-width">
        <script src="//code.jquery.com/jquery-1.12.1.min.js"></script>
		-->
		
		<!-- Bootstrap -->
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
		<meta name="viewport" content="width=device-width, initial-scale=1">
    </head>
    <body>
        <div class="jumbotron">
		  <div class="container text-center">
			<h1>Collect'IF</h1>      
			<p>{Ins√©rer un slogan ici}</p>
		  </div>
		</div>
		<div class="container-fluid bg-3 text-center"> 
			<div class="form-group">
				<label for="mail">Email:</label>
				<input id='mail' type="text" class="form-control" name='mail'>
			</div>
			
			<button type="button" class="btn" id="connexion">Se connecter</button>
			<div id='message' style='color: red;'></div>
			
			<br/>
			<p>Pas encore membre ?</p>
			<button type="button" class="btn" onclick="javascript:location.href='./i nscription.html'">INSCRIPTION</button>
        </div>
        
        <script>

            $( "#connexion" ).click(function() {
                $('#message').html('Connexion..');
                $.ajax({
                    url: './ActionServlet',
                    type: 'POST',
                    data: {
                        todo: 'connexionAdherent',
                        mail: $('#mail').val()
                    },
                    dataType: 'text'
                })
                .done(function(data) {
                    if(data.indexOf('fail')===0){
                        alert('ADHERENT NON EXISTANT')
                        $('#message').html('Veuillez entrer un mail valide !');
                    }else if(data.indexOf('success')===0){
                        window.location.href = "./adherent-accueil.html";
                        //window.location.href = "./adherent-accueil.html?idAdherent=" + data.substring(0,data.indexOf('\n'));
                    }else if(data.indexOf('admin')===0){
                        window.location.href = "./admin-accueil.html";
                    }else{
                        $('#message').html('ERREUR : veuillez recommencer');
                        console.log("data = " + data);
                    }
                   
                })
                .fail(function() {
                    $('#message').html('ERREUR Serveur : veuillez recommencer');
                })
                .always(function() {
                    //
                });

            });
        </script>
        
        
        
        
    </body>
</html>
